# Swift Plugin

The swift plugin provides versionator support for Swift Package Manager projects.

## Overview

Swift packages use `Package.swift` as the manifest file. Since `Package.swift` doesn't have a standard version field, versionator uses a comment-based convention:

```swift
// VERSION: 1.2.3
// swift-tools-version:5.9
import PackageDescription
// ...
```

## Injection Methods

| Method | Description |
|--------|-------------|
| `emit` | Generate `Version.swift` with version constants |
| `patch` | Update `// VERSION:` comment in `Package.swift` |

### Emit

Generate a Swift source file with version constants:

```bash
versionator emit swift
# Creates Sources/Version.swift
```

Generated file:

```swift
// Auto-generated by versionator. Do not edit.

public enum Version {
    public static let version = "1.2.3"
    public static let major = 1
    public static let minor = 2
    public static let patch = 3
    public static let gitHash = "abc1234"
}
```

Usage:

```swift
print("Version: \(Version.version)")
```

### Patch

Update the version comment in `Package.swift`:

```bash
versionator patch swift
```

This updates the `// VERSION: X.Y.Z` comment at the top of `Package.swift`.

## Project Structure

```
MyPackage/
├── Package.swift
├── Sources/
│   ├── MyPackage/
│   │   ├── MyPackage.swift
│   │   └── Version.swift    # Generated
└── VERSION
```

## Swift Package Manager Integration

### Reading Version from Generated File

In your package code:

```swift
import Foundation

public struct MyPackage {
    public static var version: String {
        return Version.version
    }
}
```

### Build Phase Script (Xcode)

Add a build phase to regenerate version:

```bash
versionator emit swift --output ${SRCROOT}/Sources/MyPackage/Version.swift
```

## Build System Integration

### Makefile

```makefile
version:
	versionator emit swift --output Sources/MyPackage/Version.swift

build: version
	swift build -c release
```

### CI/CD (GitHub Actions)

```yaml
- name: Generate version
  run: versionator emit swift --output Sources/MyPackage/Version.swift

- name: Build
  run: swift build -c release

- name: Test
  run: swift test
```

## Configuration

Default output path: `Sources/Version.swift`

Override with:

```bash
versionator emit swift --output Sources/MyPackage/Version.swift
```

## See Also

- [rust](../rust/) - Rust projects (similar compiled language)
- [golang](../golang/) - Go projects
