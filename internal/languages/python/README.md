# Python Plugin

The python plugin provides versionator support for modern Python projects using `pyproject.toml` (PEP 621).

## Overview

Modern Python projects use `pyproject.toml` for configuration:

```toml
[project]
name = "mypackage"
version = "1.2.3"
```

For legacy setuptools projects using `setup.cfg`, see [python-setuptools](../python-setuptools/).

## Injection Methods

| Method | Description |
|--------|-------------|
| `emit` | Generate `_version.py` with version variables |
| `patch` | Update `version` in `pyproject.toml` or `setup.py` |

### Emit

Generate a Python module with version variables:

```bash
versionator emit python
# Creates _version.py
```

Generated file:

```python
"""Auto-generated by versionator. Do not edit."""

__version__ = "1.2.3"
__version_tuple__ = (1, 2, 3)
__git_hash__ = "abc1234"
```

Usage in your package's `__init__.py`:

```python
from ._version import __version__
```

### Patch

Update the version directly in project files:

```bash
# Update pyproject.toml (recommended)
versionator patch python --file pyproject.toml

# Update setup.py (legacy)
versionator patch python --file setup.py
```

## Package Integration

### Project Structure

```
mypackage/
├── pyproject.toml
├── src/
│   └── mypackage/
│       ├── __init__.py
│       └── _version.py  # Generated
└── VERSION
```

### Dynamic Version in pyproject.toml

You can configure `pyproject.toml` to read version from the generated file:

```toml
[project]
name = "mypackage"
dynamic = ["version"]

[tool.setuptools.dynamic]
version = {attr = "mypackage._version.__version__"}
```

### Build Integration

Add to your build process:

```bash
# Before building
versionator emit python --output src/mypackage/_version.py

# Build
python -m build
```

## Build System Integration

### Makefile

```makefile
version:
	versionator emit python --output src/mypackage/_version.py

build: version
	python -m build
```

### CI/CD (GitHub Actions)

```yaml
- name: Generate version file
  run: versionator emit python --output src/mypackage/_version.py

- name: Build package
  run: python -m build

- name: Publish to PyPI
  run: twine upload dist/*
```

## Configuration

Default output path: `_version.py`

Override with:

```bash
versionator emit python --output src/mypackage/_version.py
```

## See Also

- [python-setuptools](../python-setuptools/) - Legacy setuptools projects
- [ruby](../ruby/) - Ruby projects (similar interpreted language)
